(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a3a3afc"],{1:function(t,e){},1663:function(t,e,a){"use strict";var n=a("e32e"),r=a.n(n);r.a},2:function(t,e){},"2ee3":function(t,e,a){"use strict";a.d(e,"h",function(){return r}),a.d(e,"e",function(){return s}),a.d(e,"g",function(){return o}),a.d(e,"a",function(){return i}),a.d(e,"f",function(){return l}),a.d(e,"b",function(){return u}),a.d(e,"i",function(){return c}),a.d(e,"d",function(){return d}),a.d(e,"c",function(){return f});var n=a("b775");function r(t){return Object(n["a"])({url:"/class",method:"post",data:t,baseURL:"/go-registration"})}function s(){return Object(n["a"])({url:"/class/all",method:"get",baseURL:"/go-registration"})}function o(t,e){return Object(n["a"])({url:"/student/import",method:"post",params:{classID:t},data:e,baseURL:"/go-registration"})}function i(t,e){return Object(n["a"])({url:"/student/check-in",method:"put",params:{classID:t},data:e,baseURL:"/go-registration"})}function l(t){return Object(n["a"])({url:"/class/status",method:"get",params:{classID:t},baseURL:"/go-registration"})}function u(t){return Object(n["a"])({url:"/class",method:"delete",params:{classID:t},baseURL:"/go-registration"})}function c(t,e){return Object(n["a"])({url:"/student",method:"post",params:{classID:t},data:e,baseURL:"/go-registration"})}function d(t,e){return Object(n["a"])({url:"/student",method:"put",params:{classID:t},data:e,baseURL:"/go-registration"})}function f(t,e){return Object(n["a"])({url:"/student",method:"delete",params:{classID:t,employeeID:e},baseURL:"/go-registration"})}},3:function(t,e){},"61b4":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",[a("el-main",{attrs:{height:"auto"}},[a("div",{staticClass:"app-container"},[a("upload-excel-component",{attrs:{"on-success":t.handleSuccess,"before-upload":t.beforeUpload}}),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,border:"","highlight-current-row":""}},t._l(t.tableHeader,function(t){return a("el-table-column",{key:t,attrs:{prop:t,label:t}})}),1)],1),t._v(" "),t.summitButton?a("el-col",{attrs:{span:24}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.summitUpload}},[t._v("確認上傳")])],1):t._e()],1)],1)},r=[],s=(a("b6ce"),a("5441")),o=a.n(s),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleClick}}),t._v(" "),a("div",{staticClass:"drop",on:{drop:t.handleDrop,dragover:t.handleDragover,dragenter:t.handleDragover}},[t._v("\n    Drop excel file here or\n    "),a("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:t.loading,size:"mini",type:"primary"},on:{click:t.handleUpload}},[t._v("\n      瀏覽\n    ")])],1)])},l=[],u=(a("7f7f"),a("1146")),c=a.n(u),d={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(t){var e=t.header,a=t.results;this.excelData.header=e,this.excelData.results=a,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(t){if(t.stopPropagation(),t.preventDefault(),!this.loading){var e=t.dataTransfer.files;if(1===e.length){var a=e[0];if(!this.isExcel(a))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(a),t.stopPropagation(),t.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(t){var e=t.target.files,a=e[0];a&&this.upload(a)},upload:function(t){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var e=this.beforeUpload(t);e&&this.readerData(t)}else this.readerData(t)},readerData:function(t){var e=this;return this.loading=!0,new Promise(function(a,n){var r=new FileReader;r.onload=function(t){var n=t.target.result,r=c.a.read(n,{type:"array"}),s=r.SheetNames[0],o=r.Sheets[s],i=e.getHeaderRow(o),l=c.a.utils.sheet_to_json(o);e.generateData({header:i,results:l}),e.loading=!1,a()},r.readAsArrayBuffer(t)})},getHeaderRow:function(t){var e,a=[],n=c.a.utils.decode_range(t["!ref"]),r=n.s.r;for(e=n.s.c;e<=n.e.c;++e){var s=t[c.a.utils.encode_cell({c:e,r:r})],o="UNKNOWN "+e;s&&s.t&&(o=c.a.utils.format_cell(s)),a.push(o)}return a},isExcel:function(t){return/\.(xlsx|xls|csv)$/.test(t.name)}}},f=d,p=(a("1663"),a("2877")),h=Object(p["a"])(f,i,l,!1,null,"5f418541",null),g=h.exports,m=a("2ee3"),b={name:"UploadExcel",components:{UploadExcelComponent:g},data:function(){return{tableData:[],tableHeader:[],summitButton:!1,classID:0}},created:function(){var t=this;"undefined"!==typeof this.$route.query.classID?this.classID=this.$route.query.classID:o()({title:"課程ID錯誤",message:"錯誤訊息",confirmButtonText:"離開"}).then(function(e){t.$router.push({path:"/"})})},methods:{beforeUpload:function(t){var e=t.size/1024/1024<1;return!!e||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},handleSuccess:function(t){var e=t.results,a=t.header;this.tableData=e,this.tableHeader=a,this.summitButton=!0},summitUpload:function(){var t=this;Object(m["g"])(this.classID,this.tableData).then(function(e){e.error?t.$message.error("上傳失敗"):(t.$confirm("成功上傳，是否跳轉到學員清單列表？","提示",{confirmButtonText:"跳轉",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.push({path:"/status/index",query:{classID:t.classID,t:+new Date}})}).catch(function(){t.$message({type:"info",message:"已取消跳轉"})}),t.listLoading=!1)})}}},D=b,v=Object(p["a"])(D,n,r,!1,null,null,null);e["default"]=v.exports},e32e:function(t,e,a){}}]);